"use strict";(self.webpackChunkstade_pheno=self.webpackChunkstade_pheno||[]).push([[9897],{440:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/confusion_matrix-6bbcbd78fca4d55cab1a5abe2c4f60bc.jpg"},562:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>d,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"MLops/model-evaluation","title":"\ud83e\uddea 4 - \xc9valuation du Mod\xe8le","description":"Cette section d\xe9taille le processus d\'\xe9valuation de notre mod\xe8le entra\xeen\xe9 pour la d\xe9tection des stades ph\xe9nologiques des orangers. L\'\xe9valuation est une \xe9tape critique du cycle MLOps qui permet de valider les performances et la fiabilit\xe9 du mod\xe8le avant son d\xe9ploiement.","source":"@site/docs/MLops/04-model-evaluation.md","sourceDirName":"MLops","slug":"/MLops/model-evaluation","permalink":"/stade-pheno/docs/MLops/model-evaluation","draft":false,"unlisted":false,"editUrl":"https://github.com/fatimabelgazem/stade-pheno/tree/main/docs/MLops/04-model-evaluation.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\ud83e\udde0 3 - Entra\xeenement du mod\xe8le","permalink":"/stade-pheno/docs/MLops/model-training"},"next":{"title":"\ud83d\ude80 5 - D\xe9ploiement du Mod\xe8le","permalink":"/stade-pheno/docs/MLops/model-deployment"}}');var r=n(4848),i=n(8453);const d={},l="\ud83e\uddea 4 - \xc9valuation du Mod\xe8le",a={},o=[{value:"3.1 - M\xe9thodologie d&#39;\xe9valuation",id:"31---m\xe9thodologie-d\xe9valuation",level:2},{value:"\u2699\ufe0f 3.2 - Configuration de l&#39;\xe9valuation",id:"\ufe0f-32---configuration-de-l\xe9valuation",level:2},{value:"\ud83d\udcca 3.3 - R\xe9sultats de l&#39;\xe9valuation",id:"-33---r\xe9sultats-de-l\xe9valuation",level:2},{value:"\ud83d\udcc9 M\xe9triques globales :",id:"-m\xe9triques-globales-",level:3},{value:"Performance par classe :",id:"performance-par-classe-",level:3},{value:"\ud83d\udd04 Matrice de confusion :",id:"-matrice-de-confusion-",level:3},{value:"\ud83d\uddbc\ufe0f 3.4 - Visualisation des pr\xe9dictions",id:"\ufe0f-34---visualisation-des-pr\xe9dictions",level:2},{value:"\ud83e\uddea Analyse des erreurs :",id:"-analyse-des-erreurs-",level:3},{value:"\u2705 3.6 - R\xe9sum\xe9 de l&#39;\xe9valuation",id:"-36---r\xe9sum\xe9-de-l\xe9valuation",level:2}];function c(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"-4---\xe9valuation-du-mod\xe8le",children:"\ud83e\uddea 4 - \xc9valuation du Mod\xe8le"})}),"\n",(0,r.jsx)(s.p,{children:"Cette section d\xe9taille le processus d'\xe9valuation de notre mod\xe8le entra\xeen\xe9 pour la d\xe9tection des stades ph\xe9nologiques des orangers. L'\xe9valuation est une \xe9tape critique du cycle MLOps qui permet de valider les performances et la fiabilit\xe9 du mod\xe8le avant son d\xe9ploiement."}),"\n",(0,r.jsx)(s.h2,{id:"31---m\xe9thodologie-d\xe9valuation",children:"3.1 - M\xe9thodologie d'\xe9valuation"}),"\n",(0,r.jsx)(s.p,{children:"Notre \xe9valuation suit une approche rigoureuse bas\xe9e sur plusieurs m\xe9triques compl\xe9mentaires :"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\ud83d\udcca Dataset de test :"})," 10% de notre jeu de donn\xe9es total, r\xe9serv\xe9 sp\xe9cifiquement pour l'\xe9valuation"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\ud83c\udfaf M\xe9triques principales :"})," mAP (mean Average Precision), Pr\xe9cision, Rappel, F1-Score"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"\ud83d\udd04 Validation crois\xe9e :"})," Pour garantir la robustesse des r\xe9sultats.\r\nL'\xe9valuation est r\xe9alis\xe9e de mani\xe8re ind\xe9pendante de l'entra\xeenement, conform\xe9ment aux bonnes pratiques MLOps, assurant ainsi l'int\xe9grit\xe9 des r\xe9sultats."]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"\ufe0f-32---configuration-de-l\xe9valuation",children:"\u2699\ufe0f 3.2 - Configuration de l'\xe9valuation"}),"\n",(0,r.jsx)(s.p,{children:"Pour \xe9valuer notre mod\xe8le, nous avons utilis\xe9 le mode val de YOLOv8 avec suivi via MLflow :"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'import mlflow\r\nimport os\r\nimport pandas as pd\r\n\r\n# Initialisation de MLflow pour l\'\xe9valuation\r\nmlflow.set_tracking_uri("file:///kaggle/working/mlruns")\r\nmlflow.set_experiment("YOLOv8_StadePheno1_Evaluation")\r\n\r\nwith mlflow.start_run(run_name="evaluation_final_model") as run:\r\n    # Log des param\xe8tres d\'\xe9valuation\r\n    mlflow.log_param("model_path", "/kaggle/working/datasets/runs/detect/train/weights/best.pt")\r\n    mlflow.log_param("imgsz", 800)\r\n    \r\n    # Lancement de l\'\xe9valuation\r\n    !yolo task=detect mode=val \\\r\n        model=/kaggle/working/datasets/runs/detect/train/weights/best.pt \\\r\n        data=/kaggle/working/datasets/Stade_Pheno_Dataset-3/data.yaml \\\r\n        imgsz=800\r\n\n'})}),"\n",(0,r.jsx)(s.h2,{id:"-33---r\xe9sultats-de-l\xe9valuation",children:"\ud83d\udcca 3.3 - R\xe9sultats de l'\xe9valuation"}),"\n",(0,r.jsx)(s.p,{children:"L'\xe9valuation de notre mod\xe8le a donn\xe9 d'excellents r\xe9sultats sur le jeu de donn\xe9es de test :"}),"\n",(0,r.jsx)(s.h3,{id:"-m\xe9triques-globales-",children:"\ud83d\udcc9 M\xe9triques globales :"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"M\xe9trique"}),(0,r.jsx)(s.th,{children:"Valeur"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"mAP50"}),(0,r.jsx)(s.td,{children:"0.847"}),(0,r.jsx)(s.td,{children:"Pr\xe9cision moyenne \xe0 50% IoU"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"mAP50-95"}),(0,r.jsx)(s.td,{children:"0.61"}),(0,r.jsx)(s.td,{children:"Pr\xe9cision moyenne entre 50% et 95% IoU"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Precision"}),(0,r.jsx)(s.td,{children:"0.84"}),(0,r.jsx)(s.td,{children:"Pr\xe9cision globale du mod\xe8le"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Recall"}),(0,r.jsx)(s.td,{children:"0.823"}),(0,r.jsx)(s.td,{children:"Rappel global du mod\xe8le"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"F1-Score"}),(0,r.jsx)(s.td,{children:"0.87"}),(0,r.jsx)(s.td,{children:"Moyenne harmonique de la pr\xe9cision et du rappel"})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"performance-par-classe-",children:"Performance par classe :"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Classe"}),(0,r.jsx)(s.th,{children:"Label"}),(0,r.jsx)(s.th,{children:"mAP50"}),(0,r.jsx)(s.th,{children:"Precision"}),(0,r.jsx)(s.th,{children:"Recall F1-Score"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Flower"}),(0,r.jsx)(s.td,{children:"0"}),(0,r.jsx)(s.td,{children:"0.593"}),(0,r.jsx)(s.td,{children:"0.669"}),(0,r.jsx)(s.td,{children:"0.557"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Green"}),(0,r.jsx)(s.td,{children:"1"}),(0,r.jsx)(s.td,{children:"0.958"}),(0,r.jsx)(s.td,{children:"0.87"}),(0,r.jsx)(s.td,{children:"0.958"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Mature"}),(0,r.jsx)(s.td,{children:"2"}),(0,r.jsx)(s.td,{children:"0.99"}),(0,r.jsx)(s.td,{children:"0.982"}),(0,r.jsx)(s.td,{children:"0.978"})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"-matrice-de-confusion-",children:"\ud83d\udd04 Matrice de confusion :"}),"\n",(0,r.jsx)("p",{align:"center",children:(0,r.jsx)("img",{src:n(440).A,alt:"Matrice de confusion",width:"500px"})}),"\n",(0,r.jsx)(s.p,{children:"La matrice de confusion montre une bonne classification pour toutes les classes, avec peu de confusions entre les diff\xe9rentes cat\xe9gories."}),"\n",(0,r.jsx)(s.h2,{id:"\ufe0f-34---visualisation-des-pr\xe9dictions",children:"\ud83d\uddbc\ufe0f 3.4 - Visualisation des pr\xe9dictions"}),"\n",(0,r.jsx)(s.p,{children:"Pour une \xe9valuation qualitative, nous avons observ\xe9 les pr\xe9dictions du mod\xe8le sur des images de test :"}),"\n",(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-around",alignItems:"center",flexWrap:"wrap"},children:[(0,r.jsxs)("div",{style:{textAlign:"center",width:"45%"},children:[(0,r.jsx)("img",{src:n(4001).A,alt:"Exemple de pr\xe9diction 1",style:{maxWidth:"75%",borderRadius:"10px"}}),(0,r.jsx)("p",{children:(0,r.jsx)("strong",{children:"D\xe9tection des fruits verts et des fruits matures"})})]}),(0,r.jsxs)("div",{style:{textAlign:"center",width:"45%"},children:[(0,r.jsx)("img",{src:n(4390).A,alt:"Exemple de pr\xe9diction 2",style:{maxWidth:"100%",borderRadius:"10px"}}),(0,r.jsx)("p",{children:(0,r.jsx)("strong",{children:"D\xe9tection de fruits m\xfbrs"})})]})]}),"\n",(0,r.jsx)(s.h3,{id:"-analyse-des-erreurs-",children:"\ud83e\uddea Analyse des erreurs :"}),"\n",(0,r.jsx)(s.p,{children:"Nous avons \xe9galement identifi\xe9 les cas typiques d'erreurs du mod\xe8le :"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Type d'erreur"}),(0,r.jsx)(s.th,{children:"Fr\xe9quence"}),(0,r.jsx)(s.th,{children:"Cause probable"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Faux n\xe9gatifs (fruits non d\xe9tect\xe9s)"}),(0,r.jsx)(s.td,{children:"12%"}),(0,r.jsx)(s.td,{children:"Occlusion par les feuilles"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Confusion entre fruits verts et le backgound"}),(0,r.jsx)(s.td,{children:"8%"}),(0,r.jsx)(s.td,{children:"Variations de luminosit\xe9"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"D\xe9tections multiples du m\xeame fruit"}),(0,r.jsx)(s.td,{children:"5%"}),(0,r.jsx)(s.td,{children:"Seuil IoU trop bas"})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"-36---r\xe9sum\xe9-de-l\xe9valuation",children:"\u2705 3.6 - R\xe9sum\xe9 de l'\xe9valuation"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"\xc9tape"}),(0,r.jsx)(s.th,{children:"Action r\xe9alis\xe9e"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Mod\xe8le de base"}),(0,r.jsx)(s.td,{children:'YOLOv8m pr\xe9-entra\xeen\xe9 sur "Nature3: Leaf, Flower, and Fruit Detection"'})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Fine-tuning"}),(0,r.jsx)(s.td,{children:"Entra\xeenement sur notre dataset d'orangers pendant 100 epochs"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Suivi"}),(0,r.jsx)(s.td,{children:"MLflow pour la tra\xe7abilit\xe9 des exp\xe9riences et des m\xe9triques"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"R\xe9sultat"}),(0,r.jsx)(s.td,{children:"Mod\xe8le entra\xeen\xe9 sauvegard\xe9 sous format PyTorch (.pt) pr\xeat pour \xe9valuation"})]})]})]})]})}function u(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},4001:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/pred_example1-9d587fef6f69858105092a30ba68bc58.jpg"},4390:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/pred_example2-6dc0c8e2c9a30cd474d16440d347a082.jpg"},8453:(e,s,n)=>{n.d(s,{R:()=>d,x:()=>l});var t=n(6540);const r={},i=t.createContext(r);function d(e){const s=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),t.createElement(i.Provider,{value:s},e.children)}}}]);